# Word文档格式修改流程图

## 修改内容总结

本次修改完成了以下格式调整：

1. **统一字体**：所有文字统一使用"仿宋"字体
2. **文档标题**：采用"三号字体（16pt），加粗"
3. **正文格式**：采用"四号字体（14pt），1.5倍段落距"
4. **数字格式化**：自动为数字添加千分符号（如：1000 → 1,000）
5. **表格文字**：采用"11号字体（11pt）"

## 代码流程图

```mermaid
graph TD
    A[开始转换Markdown] --> B[创建Word模板]
    B --> C[设置文档标题样式]
    C --> D{解析Markdown内容}
    
    D --> E[处理标题]
    E --> E1[应用仿宋字体]
    E1 --> E2[设置标题字号<br/>H1:22pt H2:16pt H3:14pt等]
    E2 --> E3[加粗显示]
    
    D --> F[处理正文段落]
    F --> F1[应用仿宋字体]
    F1 --> F2[设置四号字体14pt]
    F2 --> F3[设置1.5倍行距]
    F3 --> F4[格式化数字<br/>添加千分符号]
    
    D --> G[处理表格]
    G --> G1[应用仿宋字体]
    G1 --> G2[设置11号字体11pt]
    G2 --> G3[格式化表格中的数字<br/>添加千分符号]
    
    D --> H[处理图表]
    H --> H1[应用仿宋字体]
    H1 --> H2[设置四号字体14pt]
    
    E3 --> I[替换占位符]
    F4 --> I
    G3 --> I
    H2 --> I
    
    I --> J[生成最终Word文档]
    J --> K[结束]
    
    style C fill:#e1f5ff
    style E fill:#fff4e6
    style F fill:#f3e5f5
    style G fill:#e8f5e9
    style H fill:#fce4ec
    style I fill:#fff9c4
    style J fill:#c8e6c9
```

## 关键修改点

### 1. 字体统一修改
- **文件**: `template_creator.py`, `word_generator.py`
- **修改**: 所有 `'宋体'` → `'仿宋'`
- **影响范围**: 标题、正文、表格、图表标题

### 2. 文档标题格式
- **位置**: `template_creator.py` 第111行
- **修改**: `Pt(22)` → `Pt(16)` (三号字体)
- **保持**: 加粗样式

### 3. 正文格式
- **位置**: `template_creator.py` 第355行, `word_generator.py` 第157行
- **修改**: `Pt(12)` → `Pt(14)` (四号字体)
- **保持**: 1.5倍行距

### 4. 数字格式化
- **新增函数**: `format_number_with_thousands_separator()`
- **功能**: 自动识别文本中的数字并添加千分符号
- **应用位置**: 
  - 正文段落 (`template_creator.py` 第352行)
  - 文本替换 (`word_generator.py` 第152行)
  - 表格单元格 (`word_generator.py` 第258行, 第551行)

### 5. 表格字体
- **位置**: `word_generator.py` 第252行, 第536行
- **修改**: `'24'` → `'22'` (11pt，11号字体)
- **统一**: 表头和数据行都使用11号字体

## 数字格式化示例

| 原始数字 | 格式化后 |
|---------|---------|
| 1000 | 1,000 |
| 1234567 | 1,234,567 |
| 1234.56 | 1,234.56 |
| 999 | 999 (小于1000不添加) |

## 字体大小对照表

| 字号名称 | 磅值(pt) | 应用位置 |
|---------|---------|---------|
| 三号 | 16 | 文档标题 |
| 四号 | 14 | 正文、图表标题 |
| 11号 | 11 | 表格文字 |

## 注意事项

1. **数字格式化**：函数会自动识别文本中的所有数字（包括整数和小数），并添加千分符号
2. **字体兼容性**：确保系统中安装了"仿宋"字体，否则Word会使用默认字体
3. **段落间距**：正文保持1.5倍行距，符合公文格式要求
4. **表格格式**：表格中的所有文字（包括表头和数据）统一使用11号字体

